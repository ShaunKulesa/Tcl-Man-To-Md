<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://www.tcl.tk/man/tcl8.6.13/TclCmd/contents.html/Encoding/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>NAME - Tcl/Tk</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "NAME";
        var mkdocs_page_input_path = "Encoding.md";
        var mkdocs_page_url = "/man/tcl8.6.13/TclCmd/contents.html/Encoding/";
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Tcl/Tk
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../command.md">Commands</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Tcl/Tk</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
      <li>NAME</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="name">NAME</h1>
<p>encoding - Work with encodings</p>
<h1 id="synopsis">SYNOPSIS</h1>
<p><strong>encoding </strong><em>operation</em> ?<em>arg arg ...</em>?</p>
<h1 id="introduction">INTRODUCTION</h1>
<p>In Tcl every string is composed of Unicode values. Text may be encoded
into an encoding such as cp1252, iso8859-1, Shitf-JIS, utf-8, utf-16,
etc. Not every Unicode vealue is encodable in every encoding, and some
encodings can encode values that are not available in Unicode.</p>
<p>Even though Unicode is for encoding the written texts of human
languages, any sequence of bytes can be encoded as the first 255 Unicode
values. iso8859-1 an encoding for a subset of Unicode in which each byte
is a Unicode value of 255 or less. Thus, any sequence of bytes can be
considered to be a Unicode string encoded in iso8859-1. To work with
binary data in Tcl, decode it from iso8859-1 when reading it in, and
encode it into iso8859-1 when writing it out, ensuring that each
character in the string has a value of 255 or less. Decoding such a
string does nothing, and encoding encoding such a string also does
nothing.</p>
<p>For example, the following is true:</p>
<p>set text {In Tcl binary data is treated as Unicode text and it just
works.} set encoded [encoding convertto iso8859-1 \$text] expr {\$text
eq \$encoded}; #-> 1</p>
<p>The following is also true:</p>
<p>set decoded [encoding convertfrom iso8859-1 \$text] expr {\$text eq
\$decoded}; #-> 1</p>
<h1 id="description">DESCRIPTION</h1>
<p>Performs one of the following encoding <em>operations</em>:</p>
<p><strong>encoding convertfrom</strong> ?<em>encoding</em>? <em>data</em></p>
<p>:   </p>
<p><strong>encoding convertfrom</strong> ?<strong>-profile </strong><em>profile</em>? ?<strong>-failindex var</strong>? <em>encoding</em> <em>data</em></p>
<p>:   Decodes <em>data</em> encoded in <em>encoding</em>. If <em>encoding</em> is not specified
    the current system encoding is used.</p>
<p><strong>-profile</strong> determines how invalid data for the encoding are handled.
See the <strong>PROFILES</strong> section below for details. Returns an error if
decoding fails. However, if <strong>-failindex</strong> given, returns the result of
the conversion up to the point of termination, and stores in <strong>var</strong> the
index of the character that could not be converted. If no errors are
encountered the entire result of the conversion is returned and the
value <strong>-1</strong> is stored in <strong>var</strong>.</p>
<p><strong>encoding convertto</strong> ?<em>encoding</em>? <em>data</em></p>
<p>:   </p>
<p><strong>encoding convertto</strong> ?<strong>-profile </strong><em>profile</em>? ?<strong>-failindex var</strong>? <em>encoding</em> <em>data</em></p>
<p>:   Converts <em>string</em> to <em>encoding</em>. If <em>encoding</em> is not given, the
    current system encoding is used.</p>
<p>See <strong>encoding convertfrom</strong> for the meaning of <strong>-profile</strong> and
<strong>-failindex</strong>.</p>
<p><strong>encoding dirs</strong> ?<em>directoryList</em>?</p>
<p>:   Sets the search path for <strong>*.enc</strong> encoding data files to the list
    of directories given by <em>directoryList</em>. If <em>directoryList</em> is not
    given, returns the current list of directories that make up the
    search path. It is not an error for an item in <em>directoryList</em> to
    not refer to a readable, searchable directory.</p>
<p><strong>encoding names</strong></p>
<p>:   Returns a list of the names of available encodings. The encodings</p>
<p>and</p>
<p>are guaranteed to be present in the list.</p>
<p><strong>encoding profiles</strong></p>
<p>:   Returns a list of names of available encoding profiles. See
    <strong>PROFILES</strong> below.</p>
<pre><code>&lt;!-- --&gt;
</code></pre>
<p><strong>encoding system</strong> ?<em>encoding</em>?</p>
<p>:   Sets the system encoding to <em>encoding</em>. If <em>encoding</em> is not given,
    returns the current system encoding. The system encoding is used to
    pass strings to system calls.</p>
<h1 id="profiles">PROFILES</h1>
<p>Each <em>profile</em> is a distinct strategy for dealing with invalid data for
an encoding.</p>
<p>The following profiles are currently implemented.</p>
<p><strong>tcl8</strong></p>
<p>:   The default profile. Provides for behaviour identical to that of Tcl
    8.6: When decoding, for encodings <strong>other than utf-8</strong>, each invalid
    byte is interpreted as the Unicode value given by that one byte. For
    example, the byte 0x80, which is invalid in the ASCII encoding would
    be mapped to the Unicode value U+0080. For <strong>utf-8</strong>, each invalid
    byte that is a valid CP1252 character is interpreted as the Unicode
    value for that character, while each byte that is not is treated as
    the Unicode value given by that one byte. For example, byte 0x80 is
    defined by CP1252 and is therefore mapped to its Unicode equivalent
    U+20AC while byte 0x81 which is not defined by CP1252 is mapped to
    U+0081. As an additional special case, the sequence 0xC0 0x80 is
    mapped to U+0000.</p>
<p>When encoding, each character that cannot be represented in the encoding
is replaced by an encoding-dependent character, usually the question
mark <strong>?</strong>.</p>
<p><strong>strict</strong></p>
<p>:   The operation fails when invalid data for the encoding are
    encountered.</p>
<p><strong>replace</strong></p>
<p>:   When decoding, invalid bytes are replaced by U+FFFD, the Unicode
    REPLACEMENT CHARACTER.</p>
<p>When encoding, Unicode values that cannot be represented in the target
encoding are transformed to an encoding-specific fallback character,
U+FFFD REPLACEMENT CHARACTER for UTF targets, and generally `?` for
other encodings.</p>
<h1 id="examples">EXAMPLES</h1>
<p>These examples use the utility proc below that prints the Unicode value
for each character in a string.</p>
<p>proc codepoints s {join [lmap c [split \$s {}] { string cat U+
[format %.6X [scan \$c %c]]}] }</p>
<p>Example 1: Convert from euc-jp:</p>
<p>\% codepoints [<strong>encoding convertfrom</strong> euc-jp \xA4\xCF] U+00306F</p>
<p>The result is the Unicode value</p>
<p>which is the Hiragana letter HA.</p>
<p>Example 2: Error handling based on profiles:</p>
<p>The letter <strong>A</strong> is Unicode character U+0041 and the byte \"\x80\" is
invalid in ASCII encoding.</p>
<p>\% codepoints [encoding convertfrom -profile tcl8 ascii A\x80]
U+000041 U+000080 % codepoints [encoding convertfrom -profile replace
ascii A\x80] U+000041 U+00FFFD % codepoints [encoding convertfrom
-profile strict ascii A\x80] unexpected byte sequence starting at
index 1: \'\x80\'</p>
<p>Example 3: Get partial data and the error location:</p>
<p>\% codepoints [encoding convertfrom -profile strict -failindex idx
ascii AB\x80] U+000041 U+000042 % set idx 2</p>
<p>Example 4: Encode a character that is not representable in ISO8859-1:</p>
<p>\% encoding convertto iso8859-1 A\u0141 A? % encoding convertto
-profile strict iso8859-1 A\u0141 unexpected character at index 1:
\'U+000141\' % encoding convertto -profile strict -failindex idx
iso8859-1 A\u0141 A % set idx 1</p>
<h1 id="see-also">SEE ALSO</h1>
<p>Tcl_GetEncoding(3), fconfigure(n)</p>
<h1 id="keywords">KEYWORDS</h1>
<p>encoding, unicode</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
