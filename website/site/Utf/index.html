<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://www.tcl.tk/man/tcl8.6.13/TclCmd/contents.html/Utf/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>NAME - Tcl/Tk</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "NAME";
        var mkdocs_page_input_path = "Utf.md";
        var mkdocs_page_url = "/man/tcl8.6.13/TclCmd/contents.html/Utf/";
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Tcl/Tk
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../command.md">Commands</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Tcl/Tk</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
      <li>NAME</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="name">NAME</h1>
<p>Tcl_UniChar, Tcl_UniCharToUtf, Tcl_UtfToUniChar, Tcl_UtfToChar16,
Tcl_UtfToWChar, Tcl_UniCharToUtfDString, Tcl_UtfToUniCharDString,
Tcl_Char16ToUtfDString, Tcl_UtfToWCharDString, Tcl_UtfToChar16DString,
Tcl_WCharLen, Tcl_Char16Len, Tcl_UniCharLen, Tcl_UniCharNcmp,
Tcl_UniCharNcasecmp, Tcl_UniCharCaseMatch, Tcl_UtfNcmp, Tcl_UtfNcasecmp,
Tcl_UtfCharComplete, Tcl_NumUtfChars, Tcl_UtfFindFirst, Tcl_UtfFindLast,
Tcl_UtfNext, Tcl_UtfPrev, Tcl_UniCharAtIndex, Tcl_UtfAtIndex,
Tcl_UtfBackslash - routines for manipulating UTF-8 strings</p>
<h1 id="synopsis">SYNOPSIS</h1>
<pre><code>#include &lt;tcl.h&gt;

typedef ... Tcl_UniChar;

Tcl_Size
Tcl_UniCharToUtf(ch, buf)

Tcl_Size
Tcl_UtfToUniChar(src, chPtr)

Tcl_Size
Tcl_UtfToChar16(src, uPtr)

Tcl_Size
Tcl_UtfToWChar(src, wPtr)

char *
Tcl_UniCharToUtfDString(uniStr, uniLength, dsPtr)

char *
Tcl_Char16ToUtfDString(uStr, uniLength, dsPtr)

char *
Tcl_WCharToUtfDString(wStr, uniLength, dsPtr)

Tcl_UniChar *
Tcl_UtfToUniCharDString(src, length, dsPtr)

unsigned short *
Tcl_UtfToChar16DString(src, length, dsPtr)

wchar_t *
Tcl_UtfToWCharDString(src, length, dsPtr)

int
Tcl_Char16Len(uniStr)

int
Tcl_WCharLen(uniStr)

int
Tcl_UniCharLen(uniStr)

int
Tcl_UniCharNcmp(ucs, uct, uniLength)

int
Tcl_UniCharNcasecmp(ucs, uct, uniLength)

int
Tcl_UniCharCaseMatch(uniStr, uniPattern, nocase)

int
Tcl_UtfNcmp(cs, ct, length)

int
Tcl_UtfNcasecmp(cs, ct, length)

int
Tcl_UtfCharComplete(src, length)

int
Tcl_NumUtfChars(src, length)

const char *
Tcl_UtfFindFirst(src, ch)

const char *
Tcl_UtfFindLast(src, ch)

const char *
Tcl_UtfNext(src)

const char *
Tcl_UtfPrev(src, start)

int
Tcl_UniCharAtIndex(src, index)

const char *
Tcl_UtfAtIndex(src, index)

Tcl_Size
Tcl_UtfBackslash(src, readPtr, dst)
</code></pre>
<h1 id="arguments">ARGUMENTS</h1>
<p>Buffer in which the UTF-8 representation of the Tcl_UniChar is stored.
At most 4 bytes are stored in the buffer.</p>
<p>The Unicode character to be converted or examined.</p>
<p>Filled with the Tcl_UniChar represented by the head of the UTF-8 string.</p>
<p>Filled with the utf-16 represented by the head of the UTF-8 string.</p>
<p>Filled with the wchar_t represented by the head of the UTF-8 string.</p>
<p>Pointer to a UTF-8 string.</p>
<p>Pointer to a UTF-8 string.</p>
<p>Pointer to a UTF-8 string.</p>
<p>A null-terminated Unicode string.</p>
<p>A null-terminated Unicode string.</p>
<p>A null-terminated Unicode string.</p>
<p>A null-terminated Unicode string.</p>
<p>A null-terminated UTF-16 string.</p>
<p>A null-terminated wchar_t string.</p>
<p>A null-terminated utf-16 string.</p>
<p>A null-terminated utf-16 string.</p>
<p>A null-terminated utf-16 string.</p>
<p>The length of the UTF-8 string in bytes (not UTF-8 characters). If
negative, all bytes up to the first null byte are used.</p>
<p>The length of the Unicode string in characters.</p>
<p>A pointer to a previously initialized <strong>Tcl_DString</strong>.</p>
<p>Pointer to the beginning of a UTF-8 string.</p>
<p>The index of a character (not byte) in the UTF-8 string.</p>
<p>If non-NULL, filled with the number of bytes in the backslash sequence,
including the backslash character.</p>
<p>Buffer in which the bytes represented by the backslash sequence are
stored. At most 4 bytes are stored in the buffer.</p>
<p>Specifies whether the match should be done case-sensitive (0) or
case-insensitive (1).</p>
<h1 id="description">DESCRIPTION</h1>
<p>These routines convert between UTF-8 strings and Unicode/Utf-16
characters. A UTF-8 character is a Unicode character represented as a
varying-length sequence of up to <strong>4</strong> bytes. A multibyte UTF-8 sequence
consists of a lead byte followed by some number of trail bytes.</p>
<p><strong>TCL_UTF_MAX</strong> is the maximum number of bytes that <strong>Tcl_UtfToUniChar</strong>
can consume in a single call.</p>
<p><strong>Tcl_UniCharToUtf</strong> stores the character <em>ch</em> as a UTF-8 string in
starting at <em>buf</em>. The return value is the number of bytes stored in
<em>buf</em>. The character <em>ch</em> can be or\'ed with the value TCL_COMBINE to
enable special behavior, compatible with Tcl 8.x. Then, if ch is a high
surrogate (range U+D800 - U+DBFF), the return value will be 1 and a
single byte in the range 0xF0 - 0xF4 will be stored. If <em>ch</em> is a low
surrogate (range U+DC00 - U+DFFF), an attempt is made to combine the
result with the earlier produced bytes, resulting in a 4-byte UTF-8 byte
sequence.</p>
<p><strong>Tcl_UtfToUniChar</strong> reads one UTF-8 character starting at <em>src</em> and
stores it as a Tcl_UniChar in <em>*chPtr</em>. The return value is the number
of bytes read from <em>src</em>. The caller must ensure that the source buffer
is long enough such that this routine does not run off the end and
dereference non-existent or random memory; if the source buffer is known
to be null-terminated, this will not happen. If the input is a byte in
the range 0x80 - 0x9F, <strong>Tcl_UtfToUniChar</strong> assumes the cp1252 encoding,
stores the corresponding Tcl_UniChar in <em>*chPtr</em> and returns 1. If the
input is otherwise not in proper UTF-8 format, <strong>Tcl_UtfToUniChar</strong> will
store the first byte of <em>src</em> in <em>*chPtr</em> as a Tcl_UniChar between
0x00A0 and 0x00FF and return 1.</p>
<p><strong>Tcl_UniCharToUtfDString</strong> converts the given Unicode string to UTF-8,
storing the result in a previously initialized <strong>Tcl_DString</strong>. The
return value is a pointer to the UTF-8 representation of the Unicode
string. Storage for the return value is appended to the end of the
<strong>Tcl_DString</strong>.</p>
<p><strong>Tcl_UtfToUniCharDString</strong> converts the given UTF-8 string to Unicode,
storing the result in the previously initialized <strong>Tcl_DString</strong>. In the
argument <em>length</em>, you may either specify the length of the given UTF-8
string in bytes or</p>
<p>in which case <strong>Tcl_UtfToUniCharDString</strong> uses <strong>strlen</strong> to calculate
the length. The return value is a pointer to the Unicode representation
of the UTF-8 string. Storage for the return value is appended to the end
of the <strong>Tcl_DString</strong>. The Unicode string is terminated with a Unicode
null character.</p>
<p><strong>Tcl_Char16Len</strong> corresponds to <strong>strlen</strong> for UTF-16 characters. It
accepts a null-terminated Unicode string and returns the number of
Unicode characters (not bytes) in that string.</p>
<p><strong>Tcl_WCharLen</strong> corresponds to <strong>strlen</strong> for wchar_t characters. It
accepts a null-terminated Unicode string and returns the number of
Unicode characters (not bytes) in that string.</p>
<p><strong>Tcl_UniCharLen</strong> corresponds to <strong>strlen</strong> for Unicode characters. It
accepts a null-terminated Unicode string and returns the number of
Unicode characters (not bytes) in that string.</p>
<p><strong>Tcl_UniCharNcmp</strong> and <strong>Tcl_UniCharNcasecmp</strong> correspond to
<strong>strncmp</strong> and <strong>strncasecmp</strong>, respectively, for Unicode characters.
They accept two null-terminated Unicode strings and the number of
characters to compare. Both strings are assumed to be at least
<em>uniLength</em> characters long. <strong>Tcl_UniCharNcmp</strong> compares the two
strings character-by-character according to the Unicode character
ordering. It returns an integer greater than, equal to, or less than 0
if the first string is greater than, equal to, or less than the second
string respectively. <strong>Tcl_UniCharNcasecmp</strong> is the Unicode case
insensitive version.</p>
<p><strong>Tcl_UniCharCaseMatch</strong> is the Unicode equivalent to
<strong>Tcl_StringCaseMatch</strong>. It accepts a null-terminated Unicode string, a
Unicode pattern, and a boolean value specifying whether the match should
be case sensitive and returns whether the string matches the pattern.</p>
<p><strong>Tcl_UtfNcmp</strong> corresponds to <strong>strncmp</strong> for UTF-8 strings. It accepts
two null-terminated UTF-8 strings and the number of characters to
compare. (Both strings are assumed to be at least <em>length</em> characters
long.) <strong>Tcl_UtfNcmp</strong> compares the two strings character-by-character
according to the Unicode character ordering. It returns an integer
greater than, equal to, or less than 0 if the first string is greater
than, equal to, or less than the second string respectively.</p>
<p><strong>Tcl_UtfNcasecmp</strong> corresponds to <strong>strncasecmp</strong> for UTF-8 strings. It
is similar to <strong>Tcl_UtfNcmp</strong> except comparisons ignore differences in
case when comparing upper, lower or title case characters.</p>
<p><strong>Tcl_UtfCharComplete</strong> returns 1 if the source UTF-8 string <em>src</em> of
<em>length</em> bytes is long enough to be decoded by
<strong>Tcl_UtfToUniChar</strong>/<strong>Tcl_UtfNext</strong>, or 0 otherwise. This function does
not guarantee that the UTF-8 string is properly formed. This routine is
used by procedures that are operating on a byte at a time and need to
know if a full Unicode character has been seen.</p>
<p><strong>Tcl_NumUtfChars</strong> corresponds to <strong>strlen</strong> for UTF-8 strings. It
returns the number of Tcl_UniChars that are represented by the UTF-8
string <em>src</em>. The length of the source string is <em>length</em> bytes. If the
length is negative, all bytes up to the first null byte are used.</p>
<p><strong>Tcl_UtfFindFirst</strong> corresponds to <strong>strchr</strong> for UTF-8 strings. It
returns a pointer to the first occurrence of the Unicode character <em>ch</em>
in the null-terminated UTF-8 string <em>src</em>. The null terminator is
considered part of the UTF-8 string.</p>
<p><strong>Tcl_UtfFindLast</strong> corresponds to <strong>strrchr</strong> for UTF-8 strings. It
returns a pointer to the last occurrence of the Unicode character <em>ch</em>
in the null-terminated UTF-8 string <em>src</em>. The null terminator is
considered part of the UTF-8 string.</p>
<p>Given <em>src</em>, a pointer to some location in a UTF-8 string,
<strong>Tcl_UtfNext</strong> returns a pointer to the next UTF-8 character in the
string. The caller must not ask for the next character after the last
character in the string if the string is not terminated by a null
character. <strong>Tcl_UtfCharComplete</strong> can be used in that case to make sure
enough bytes are available before calling <strong>Tcl_UtfNext</strong>.</p>
<p><strong>Tcl_UtfPrev</strong> is used to step backward through but not beyond the
UTF-8 string that begins at <em>start</em>. If the UTF-8 string is made up
entirely of complete and well-formed characters, and <em>src</em> points to the
lead byte of one of those characters (or to the location one byte past
the end of the string), then repeated calls of <strong>Tcl_UtfPrev</strong> will
return pointers to the lead bytes of each character in the string, one
character at a time, terminating when it returns <em>start</em>.</p>
<p>When the conditions of completeness and well-formedness may not be
satisfied, a more precise description of the function of <strong>Tcl_UtfPrev</strong>
is necessary. It always returns a pointer greater than or equal to
<em>start</em>; that is, always a pointer to a location in the string. It
always returns a pointer to a byte that begins a character when scanning
for characters beginning from <em>start</em>. When <em>src</em> is greater than
<em>start</em>, it always returns a pointer less than <em>src</em> and greater than or
equal to (<em>src</em> - 4). The character that begins at the returned pointer
is the first one that either includes the byte <em>src[-1]</em>, or might
include it if the right trail bytes are present at <em>src</em> and greater.
<strong>Tcl_UtfPrev</strong> never reads the byte <em>src[0]</em> nor the byte
<em>start[-1]</em> nor the byte <em>src[-5]</em>.</p>
<p><strong>Tcl_UniCharAtIndex</strong> corresponds to a C string array dereference or
the Pascal Ord() function. It returns the Unicode character represented
at the specified character (not byte) <em>index</em> in the UTF-8 string <em>src</em>.
The source string must contain at least <em>index</em> characters. If <em>index</em>
is negative or <em>index</em> points to the second half of a surrogate pair, it
returns -1.</p>
<p><strong>Tcl_UtfAtIndex</strong> returns a pointer to the specified character (not
byte) <em>index</em> in the UTF-8 string <em>src</em>. The source string must contain
at least <em>index</em> characters. This is equivalent to calling
<strong>Tcl_UtfToUniChar</strong> <em>index</em> times. If <em>index</em> is negative, the return
pointer points to the first character in the source string.</p>
<p><strong>Tcl_UtfBackslash</strong> is a utility procedure used by several of the Tcl
commands. It parses a backslash sequence and stores the properly formed
UTF-8 character represented by the backslash sequence in the output
buffer <em>dst</em>. At most 4 bytes are stored in the buffer.
<strong>Tcl_UtfBackslash</strong> modifies <em>*readPtr</em> to contain the number of bytes
in the backslash sequence, including the backslash character. The return
value is the number of bytes stored in the output buffer.</p>
<p>See the <strong>Tcl</strong> manual entry for information on the valid backslash
sequences. All of the sequences described in the Tcl manual entry are
supported by <strong>Tcl_UtfBackslash</strong>.</p>
<h1 id="keywords">KEYWORDS</h1>
<p>utf, unicode, backslash</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
