<!DOCTYPE html>
<html lang="en">
    <head>
      <script>
	// Hack for scrolling window when linking to anchor tag with fixed nav header
        var shiftWindow = function() { scrollBy(0, -75) };
        window.addEventListener("hashchange", shiftWindow);
        function load() { if (window.location.hash) shiftWindow(); }
      </script>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://www.tcl.tk/man/TkLib/TextLayout/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>TextLayout - Tcl/Tk</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link href="../../css/font-awesome.min.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script src="../../js/base.js"></script> 
    </head>

    <body class="">

      <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
	<div class="container">
	<a class="navbar-brand" href="../..">Tcl/Tk</a>
	<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample04" aria-controls="navbarsExample04" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
	</button>

	<div class="collapse navbar-collapse">

          <ul class="navbar-nav flex-row ml-md-auto d-none d-md-flex">
            <li class="nav-item">
              <a class="nav-link" href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
		<i class="fa fa-search"></i> Search
              </a>
            </li>
          </ul>
	</div>
	</div>
      </nav><div id="content" class="container">
        
      <div class="row">
        <div class="col-md-9" role="main">


<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    
    <li class="breadcrumb-item active" aria-current="page">TextLayout</li>
  </ol>
</nav>


<p>\</p>
<h1 id="name">NAME</h1>
<p>Tk_ComputeTextLayout, Tk_FreeTextLayout, Tk_DrawTextLayout,
Tk_UnderlineTextLayout, Tk_PointToChar, Tk_CharBbox,
Tk_DistanceToTextLayout, Tk_IntersectTextLayout,
Tk_TextLayoutToPostscript - routines to measure and display single-font,
multi-line, justified text.</p>
<h1 id="synopsis">SYNOPSIS</h1>
<p><strong>#include \&lt;tk.h></strong></p>
<p>Tk_TextLayout <strong>Tk_ComputeTextLayout(</strong><em>tkfont, string, numChars,
wrapLength, justify, flags, widthPtr, heightPtr</em><strong>)</strong></p>
<p>void <strong>Tk_FreeTextLayout(</strong><em>layout</em><strong>)</strong></p>
<p>void <strong>Tk_DrawTextLayout(</strong><em>display, drawable, gc, layout, x, y,
firstChar, lastChar</em><strong>)</strong></p>
<p>void <strong>Tk_UnderlineTextLayout(</strong><em>display, drawable, gc, layout, x, y,
underline</em><strong>)</strong></p>
<p>int <strong>Tk_PointToChar(</strong><em>layout, x, y</em><strong>)</strong></p>
<p>int <strong>Tk_CharBbox(</strong><em>layout, index, xPtr, yPtr, widthPtr,
heightPtr</em><strong>)</strong></p>
<p>int <strong>Tk_DistanceToTextLayout(</strong><em>layout, x, y</em><strong>)</strong></p>
<p>int <strong>Tk_IntersectTextLayout(</strong><em>layout, x, y, width, height</em><strong>)</strong></p>
<p>void <strong>Tk_TextLayoutToPostscript(</strong><em>interp, layout</em><strong>)</strong></p>
<h1 id="arguments">ARGUMENTS</h1>
<p>Font to use when constructing and displaying a text layout. The <em>tkfont</em>
must remain valid for the lifetime of the text layout. Must have been
returned by a previous call to <strong>Tk_GetFont</strong>.</p>
<p>Potentially multi-line string whose dimensions are to be computed and
stored in the text layout. The <em>string</em> must remain valid for the
lifetime of the text layout.</p>
<p>The number of characters to consider from <em>string</em>. If <em>numChars</em> is
less than 0, then assumes <em>string</em> is null terminated and uses
<strong>Tcl_NumUtfChars</strong> to determine the length of <em>string</em>.</p>
<p>Longest permissible line length, in pixels. Lines in <em>string</em> will
automatically be broken at word boundaries and wrapped when they reach
this length. If <em>wrapLength</em> is too small for even a single character to
fit on a line, it will be expanded to allow one character to fit on each
line. If <em>wrapLength</em> is \&lt;= 0, there is no automatic wrapping; lines
will get as long as they need to be and only wrap if a newline/return
character is encountered.</p>
<p>How to justify the lines in a multi-line text layout. Possible values
are <strong>TK_JUSTIFY_LEFT</strong>, <strong>TK_JUSTIFY_CENTER</strong>, or <strong>TK_JUSTIFY_RIGHT</strong>.
If the text layout only occupies a single line, then <em>justify</em> is
irrelevant.</p>
<p>Various flag bits OR-ed together. <strong>TK_IGNORE_TABS</strong> means that tab
characters should not be expanded to the next tab stop.
<strong>TK_IGNORE_NEWLINES</strong> means that newline/return characters should not
cause a line break. If either tabs or newlines/returns are ignored, then
they will be treated as regular characters, being measured and displayed
in a platform-dependent manner as described in <strong>Tk_MeasureChars</strong>, and
will not have any special behaviors.</p>
<p>If non-NULL, filled with either the width, in pixels, of the widest line
in the text layout, or the width, in pixels, of the bounding box for the
character specified by <em>index</em>.</p>
<p>If non-NULL, filled with either the total height, in pixels, of all the
lines in the text layout, or the height, in pixels, of the bounding box
for the character specified by <em>index</em>.</p>
<p>A token that represents the cached layout information about the
single-font, multi-line, justified piece of text. This token is returned
by <strong>Tk_ComputeTextLayout</strong>.</p>
<p>Display on which to draw.</p>
<p>Window or pixmap in which to draw.</p>
<p>Graphics context to use for drawing text layout. The font selected in
this GC must correspond to the <em>tkfont</em> used when constructing the text
layout.</p>
<p>Point, in pixels, at which to place the upper-left hand corner of the
text layout when it is being drawn, or the coordinates of a point (with
respect to the upper-left hand corner of the text layout) to check
against the text layout.</p>
<p>The index of the first character to draw from the given text layout. The
number 0 means to draw from the beginning.</p>
<p>The index of the last character up to which to draw. The character
specified by <em>lastChar</em> itself will not be drawn. A number less than 0
means to draw all characters in the text layout.</p>
<p>Index of the single character to underline in the text layout, or a
number less than 0 for no underline.</p>
<p>The index of the character whose bounding box is desired. The bounding
box is computed with respect to the upper-left hand corner of the text
layout.</p>
<p>Filled with the upper-left hand corner, in pixels, of the bounding box
for the character specified by <em>index</em>. Either or both <em>xPtr</em> and <em>yPtr</em>
may be NULL, in which case the corresponding value is not calculated.</p>
<p>Specifies the width and height, in pixels, of the rectangular area to
compare for intersection against the text layout.</p>
<p>Postscript code that will print the text layout is appended to the
result of interpreter <em>interp</em>.</p>
<p>\</p>
<h1 id="description">DESCRIPTION</h1>
<p>These routines are for measuring and displaying single-font, multi-line,
justified text. To measure and display simple single-font, single-line
strings, refer to the documentation for <strong>Tk_MeasureChars</strong>. There is no
programming interface in the core of Tk that supports multi-font,
multi-line text; support for that behavior must be built on top of
simpler layers. Note that unlike the lower level text display routines,
the functions described here all operate on character-oriented lengths
and indices rather than byte-oriented values. See the description of
<strong>Tcl_UtfAtIndex</strong> for more details on converting between character and
byte offsets.</p>
<p>The routines described here are built on top of the programming
interface described in the <strong>Tk_MeasureChars</strong> documentation. Tab
characters and newline/return characters may be treated specially by
these procedures, but all other characters are passed through to the
lower level.</p>
<p><strong>Tk_ComputeTextLayout</strong> computes the layout information needed to
display a single-font, multi-line, justified <em>string</em> of text and
returns a Tk_TextLayout token that holds this information. This token is
used in subsequent calls to procedures such as <strong>Tk_DrawTextLayout</strong>,
<strong>Tk_DistanceToTextLayout</strong>, and <strong>Tk_FreeTextLayout</strong>. The <em>string</em> and
<em>tkfont</em> used when computing the layout must remain valid for the
lifetime of this token.</p>
<p><strong>Tk_FreeTextLayout</strong> is called to release the storage associated with
<em>layout</em> when it is no longer needed. A <em>layout</em> should not be used in
any other text layout procedures once it has been released.</p>
<p><strong>Tk_DrawTextLayout</strong> uses the information in <em>layout</em> to display a
single-font, multi-line, justified string of text at the specified
location.</p>
<p><strong>Tk_UnderlineTextLayout</strong> uses the information in <em>layout</em> to display
an underline below an individual character. This procedure does not draw
the text, just the underline. To produce natively underlined text, an
underlined font should be constructed and used. All characters,
including tabs, newline/return characters, and spaces at the ends of
lines, can be underlined using this method. However, the underline will
never be drawn outside of the computed width of <em>layout</em>; the underline
will stop at the edge for any character that would extend partially
outside of <em>layout</em>, and the underline will not be visible at all for
any character that would be located completely outside of the layout.</p>
<p><strong>Tk_PointToChar</strong> uses the information in <em>layout</em> to determine the
character closest to the given point. The point is specified with
respect to the upper-left hand corner of the <em>layout</em>, which is
considered to be located at (0, 0). Any point whose <em>y</em>-value is less
that 0 will be considered closest to the first character in the text
layout; any point whose <em>y</em>-value is greater than the height of the text
layout will be considered closest to the last character in the text
layout. Any point whose <em>x</em>-value is less than 0 will be considered
closest to the first character on that line; any point whose <em>x</em>-value
is greater than the width of the text layout will be considered closest
to the last character on that line. The return value is the index of the
character that was closest to the point, or one more than the index of
any character (to indicate that the point was after the end of the
string and that the corresponding caret would be at the end of the
string). Given a <em>layout</em> with no characters, the value 0 will always be
returned, referring to a hypothetical zero-width placeholder character.</p>
<p><strong>Tk_CharBbox</strong> uses the information in <em>layout</em> to return the bounding
box for the character specified by <em>index</em>. The width of the bounding
box is the advance width of the character, and does not include any left
or right bearing. Any character that extends partially outside of
<em>layout</em> is considered to be truncated at the edge. Any character that
would be located completely outside of <em>layout</em> is considered to be
zero-width and pegged against the edge. The height of the bounding box
is the line height for this font, extending from the top of the ascent
to the bottom of the descent; information about the actual height of
individual letters is not available. For measurement purposes, a
<em>layout</em> that contains no characters is considered to contain a single
zero-width placeholder character at index 0. If <em>index</em> was not a valid
character index, the return value is 0 and <em>*xPtr</em>, <em>*yPtr</em>,
<em>*widthPtr</em>, and <em>*heightPtr</em> are unmodified. Otherwise, if <em>index</em>
did specify a valid, the return value is non-zero, and <em>*xPtr</em>,
<em>*yPtr</em>, <em>*widthPtr</em>, and <em>*heightPtr</em> are filled with the bounding
box information for the character. If any of <em>xPtr</em>, <em>yPtr</em>, <em>widthPtr</em>,
or <em>heightPtr</em> are NULL, the corresponding value is not calculated or
stored.</p>
<p><strong>Tk_DistanceToTextLayout</strong> computes the shortest distance in pixels
from the given point (<em>x, y</em>) to the characters in <em>layout</em>.
Newline/return characters and non-displaying space characters that occur
at the end of individual lines in the text layout are ignored for hit
detection purposes, but tab characters are not. The return value is 0 if
the point actually hits the <em>layout</em>. If the point did not hit the
<em>layout</em> then the return value is the distance in pixels from the point
to the <em>layout</em>.</p>
<p><strong>Tk_IntersectTextLayout</strong> determines whether a <em>layout</em> lies entirely
inside, entirely outside, or overlaps a given rectangle. Newline/return
characters and non-displaying space characters that occur at the end of
individual lines in the <em>layout</em> are ignored for intersection
calculations. The return value is -1 if the <em>layout</em> is entirely outside
of the rectangle, 0 if it overlaps, and 1 if it is entirely inside of
the rectangle.</p>
<p><strong>Tk_TextLayoutToPostscript</strong> outputs code consisting of a Postscript
array of strings that represent the individual lines in <em>layout</em>. It is
the responsibility of the caller to take the Postscript array of strings
and add some Postscript function operate on the array to render each of
the lines. The code that represents the Postscript array of strings is
appended to interpreter <em>interp</em>\'s result.</p>
<h1 id="display-model">DISPLAY MODEL</h1>
<p>When measuring a text layout, space characters that occur at the end of
a line are ignored. The space characters still exist and the insertion
point can be positioned amongst them, but their additional width is
ignored when justifying lines or returning the total width of a text
layout. All end-of-line space characters are considered to be attached
to the right edge of the line; this behavior is logical for
left-justified text and reasonable for center-justified text, but not
very useful when editing right-justified text. Spaces are considered
variable width characters; the first space that extends past the edge of
the text layout is clipped to the edge, and any subsequent spaces on the
line are considered zero width and pegged against the edge. Space
characters that occur in the middle of a line of text are not suppressed
and occupy their normal space width.</p>
<p>Tab characters are not ignored for measurement calculations. If wrapping
is turned on and there are enough tabs on a line, the next tab will wrap
to the beginning of the next line. There are some possible strange
interactions between tabs and justification; tab positions are
calculated and the line length computed in a left-justified world, and
then the whole resulting line is shifted so it is centered or
right-justified, causing the tab columns not to align any more.</p>
<p>When wrapping is turned on, lines may wrap at word breaks (space or tab
characters) or newline/returns. A dash or hyphen character in the middle
of a word is not considered a word break. <strong>Tk_ComputeTextLayout</strong>
always attempts to place at least one word on each line. If it cannot
because the <em>wrapLength</em> is too small, the word will be broken and as
much as fits placed on the line and the rest on subsequent line(s). If
<em>wrapLength</em> is so small that not even one character can fit on a given
line, the <em>wrapLength</em> is ignored for that line and one character will
be placed on the line anyhow. When wrapping is turned off, only
newline/return characters may cause a line break.</p>
<p>When a text layout has been created using an underlined <em>tkfont</em>, then
any space characters that occur at the end of individual lines,
newlines/returns, and tabs will not be displayed underlined when
<strong>Tk_DrawTextLayout</strong> is called, because those characters are never
actually drawn - they are merely placeholders maintained in the
<em>layout</em>.</p>
<h1 id="keywords">KEYWORDS</h1>
<p>font</p>

<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
  <li class="last-updated-holder displayDate loading">
    <span class="last-updated-text">Last updated:</span>
    <time role="presentation" datetime="2018-10-25T00:00:00.000Z" data-article-date-source="ms.date"></time>
  </li>
<!--
  <li class="readingTime">
    2 minutes to read
  </li>
-->
  <li class="contributors-holder">
    <span class="contributors-text">Contributors</span>
    <ul class="contributors" data-bi-name="contributors"></ul>
  </li>
</ul>
</div>
        <div class="col-md-3"><div class="navbar-light navbar-expand-md hidden-print sticky-top sticky-offset" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    <div id="toc-collapse" class="navbar-collapse collapse card">
        <ul class="nav flex-column bs-sidenav">
            <li class="nav-item main"><a class="nav-link" href="#name">NAME</a></li>
            <li class="nav-item main"><a class="nav-link" href="#synopsis">SYNOPSIS</a></li>
            <li class="nav-item main"><a class="nav-link" href="#arguments">ARGUMENTS</a></li>
            <li class="nav-item main"><a class="nav-link" href="#description">DESCRIPTION</a></li>
            <li class="nav-item main"><a class="nav-link" href="#display-model">DISPLAY MODEL</a></li>
            <li class="nav-item main"><a class="nav-link" href="#keywords">KEYWORDS</a></li>
        </ul>
    </div>
</div></div>
      </div>
      </div>

      <footer class="col-md-12">
	<hr>
	<div class="container">
	</div>
      </footer>
      <script>
	var base_url = "../..",
            shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
      </script>
      <script src="../../js/base.js" defer></script>
      <script src="../../search/main.js" defer></script>

      <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <p class="h4 modal-title">Keyboard Shortcuts</p>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
